<html>
<body>
	<input type="submit" onclick="connectAndPrint()" value="Print"/>
	<script>
	var device;

	function setup(device) {
		return device.open()
		.then(() => device.selectConfiguration(1))
		.then(() => device.claimInterface(0))
	}

	function print(rawData) {
		
		var data = Uint8Array.from(atob(rawData), c => c.charCodeAt(0))

		console.log(data);
		console.log(rawData);
		device.transferOut(1, data)
		.catch(error => { console.log(error); })
	}

	function connectAndPrint() {
		var rawData = "G0AbTQEdV0AAG2EBRkFLVFVSIFBFTkpVQUxBTgodV0AAG2EBGzMQGyoAgAAAAAAAAAAAAAEBAwMHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcDAwEAAAAAAAAAAAobKgCAAAAAAw8/Pvjw4MCAgQEBAQEBAQEBAQEBAQEBAQAAAQEBAQAAAAAAAAAAAAAAAAAAAAABAQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEBAAAAAQEBAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBgYDA4OB4fD8PBwEAChsqAIAAH////4AAAAAAAACAgICAgMD/////wICAgICAAAD/////AAAAID8/HwAAP39/fygA/////wAAAA8fPz95cHBwcHB/Pz8fAAAHDx8/Pzh4eHAAAAC//78fAAD/////cHAAAA8fPz9/dnJ2cn5+Ph4eBgAA////AAAAAAAAAP///z8KGyoAgAAA4PD+fg8HAwEAAAAAAAAAAODg4OAAAAAAAAAAAODg4OAAAAAA4ODgAADA4ODgQADg4ODgAAAAAMDA4OBgYGBg4ODg4MAAAODg4ODgAAAAAAAAAODg4OAAAMDg4OBgYCAAgMDg4OBgYGBgYGDgwMAAAADg4OAAAAABAw8//vjwgAobKgCAAAAAAAAAgMDA4PBweDg8PBgcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwYHDg4eHjw8ODAgAAAAAAAChsqAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKGzIKG2EBHVdAAENWLiBCVU1JIFRFTEFEQU4KG2EBOTQuMTk0Ljc2MC44LTY0Ny4wMDAKG2EBSkwuIEFMVU4tQUxVTiBUSU1VUiwgTk8gNywgUE9OT1JPR08KG2EBMDgxIDMzNSA3ODkgOTk1LzA4MjIgMzQ4NCA1NzUzCh1WQQM=";
		if (device == null) {
			navigator.usb.requestDevice({ filters: [{ vendorId: 1208 }] })
			.then(selectedDevice => {
				device = selectedDevice;
				console.log(device);
				return setup(device);
			})
			.then(() => print(rawData))
			.catch(error => { console.log(error); })
		}
		else
			print(rawData);
	}

	navigator.usb.getDevices()
	.then(devices => {
		if (devices.length > 0) {
			device = devices[0];
			return setup(device);
		}
	})
	.catch(error => { console.log(error); });

	</script>
</body>
</html>

